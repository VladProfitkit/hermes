!function(i){var t={show_gallerys:"one",show_images:"mix",loop:!0,show_text:"alt&caption",lightbox_size:"fit",position:"middle",margin:20,window_scroll:!1,hide_on_esc:!0,hide_on_overlay:!0,resize:"super_smooth",show_hash:!0};t.sys={link_pattern:"(jpg|jpe|jpeg|gif|png|bmp)$",gallery_container:"div.gallery",image_caption:".wp-caption-text",overlay_css:{position:"fixed",zIndex:9999,left:0,top:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)"},lightbox_css:{position:"fixed",zIndex:"10000",left:0,top:0,width:"100%",height:0},show_loading_timeout:300,preload_next:!0},i(document).ready(function(){var o,e,n,h,l,a=RegExp(t.sys.link_pattern,"i"),g=function(n){var h,l=document;"mix"==t.show_gallerys&&"mix"==t.show_images||(h=n.parents(t.sys.gallery_container)).length>0&&"one"==t.show_gallerys&&(l=h[0]);var g=0;o=[],i(l).find("a:has(img)").each(function(){a.test(i(this).attr("href"))&&("mix"==t.show_gallerys&&"mix"==t.show_images||h.length>0&&"mix"==t.show_gallerys&&i(this).parents(t.sys.gallery_container).length>0||h.length>0&&"one"==t.show_gallerys||0==h.length&&"mix"==t.show_images&&0==i(this).parents(t.sys.gallery_container).length)&&(o[g]=i(this),i(this).is(n)&&(e=g),g++)}),s(n)},s=function(l){0==i("#lightbox").length&&(i("<div/>",{id:"lightbox_overlay"}).css(t.sys.overlay_css).hide().appendTo("body"),i('<div id="lightbox">                    <div class="lightbox_window">                        <div class="lightbox_img"><img src="" alt=""><div class="lightbox_loading"></div></div>                        <div class="lightbox_prev"></div>                        <div class="lightbox_next"></div>                        <div class="lightbox_description"></div>                        <div class="lightbox_close"></div>                    </div>                </div>').appendTo("body"),i("#lightbox").css(t.sys.lightbox_css),i("#lightbox img").css({width:"100px",height:"100px"}),n=i("#lightbox .lightbox_window").outerWidth()-100,h=i("#lightbox .lightbox_window").outerHeight()-100,i("#lightbox").hide(),i("#lightbox .lightbox_prev").click(d),i("#lightbox .lightbox_next, #lightbox img").click(c),i("#lightbox .lightbox_close").click(function(){r()}),t.hide_on_esc&&i(document).keyup(function(i){27==i.keyCode&&r()}),t.hide_on_overlay&&i("#lightbox_overlay").click(r)),x(l),o.length>1?(i("#lightbox .lightbox_prev, #lightbox .lightbox_next").show(),i("#lightbox .lightbox_next, #lightbox .lightbox_prev, #lightbox img").removeClass("inactive"),t.loop||(0==e?i("#lightbox .lightbox_prev").addClass("inactive"):e+1==o.length&&i("#lightbox .lightbox_next, #lightbox img").addClass("inactive"))):(i("#lightbox .lightbox_prev, #lightbox .lightbox_next").hide(),i("#lightbox img").addClass("inactive")),"top"==t.position?i("#lightbox").css({marginTop:t.margin}):i("#lightbox").css({marginTop:(Math.max(document.documentElement.clientHeight,window.innerHeight||0)-100-h)/2}),i("#lightbox_overlay").fadeIn(200,function(){i("#lightbox").fadeIn(200)}),t.window_scroll||i("body").css({overflow:"hidden"})},r=function(){i("#lightbox_overlay").fadeOut(300),i("#lightbox").fadeOut(300,function(){i("#lightbox img").attr("src","").css({width:"100px",height:"100px",background:"none"})}),t.window_scroll||i("body").css({overflow:"auto"}),t.show_hash&&(window.location.hash="no-image")},c=function(){o.length>1&&(t.loop||e+1<o.length)&&(e+1<o.length?e++:e=0,x(o[e]),t.loop||(e+1==o.length&&i("#lightbox .lightbox_next, #lightbox img").addClass("inactive"),1==e&&i("#lightbox .lightbox_prev").removeClass("inactive")))},d=function(){o.length>1&&(t.loop||e-1>=0)&&(e-1>=0?e--:e=o.length-1,x(o[e]),t.loop||(0==e&&i("#lightbox .lightbox_prev").addClass("inactive"),e+1==o.length-1&&i("#lightbox .lightbox_next, #lightbox img").removeClass("inactive")))},x=function(a){var g=a.attr("href");l=setTimeout(function(){"super_smooth"==t.resize?(i("#lightbox div.lightbox_img").css({background:"none"}),i("#lightbox img").animate({opacity:.5},1e3)):i("#lightbox img").attr("src",""),i("#lightbox div.lightbox_loading").show(),b()},t.sys.show_loading_timeout),i("<img>").attr("src",g).on("load",function(){var s;if(!o[e]||o[e].is(a)){var r,c;clearTimeout(l),b(),i("#lightbox div.lightbox_loading").hide();var d=new_iw=this.width,x=new_ih=this.height,p=Math.max(document.documentElement.clientWidth,window.innerWidth||0),m=Math.max(document.documentElement.clientHeight,window.innerHeight||0);t.lightbox_size.match(/^(\d+)x(\d+)$/)?(r=RegExp.$1,c=RegExp.$2):"full"!=t.lightbox_size&&(r=p-2*t.margin-n,c=m-2*t.margin-h),r&&(new_iw>r&&(new_iw=r,new_ih=x/d*new_iw),new_ih>c&&(new_ih=c,new_iw=d/x*new_ih)),"fit"!=t.lightbox_size&&(new_iw+2*t.margin+n>p||new_ih+2*t.margin+h>m?i("#lightbox").css({position:"absolute",top:i(window).scrollTop()}):i("#lightbox").css({position:"fixed",top:0})),s="top"==t.position?t.margin:(m-new_ih-h)/2,"smooth"!=t.resize||i("#lightbox img").width()==new_iw&&i("#lightbox img").height()==new_ih?"super_smooth"==t.resize?(i("#lightbox div.lightbox_img").css({backgroundImage:"url('"+g+"')",backgroundSize:new_iw+"px "+new_ih+"px",backgroundPosition:"50% 50%",backgroundRepeat:"no-repeat"}),i("#lightbox img").attr("src",""),i("#lightbox").animate({marginTop:s},{duration:500,start:function(){i("#lightbox img").stop().animate({opacity:0,width:new_iw,height:new_ih},500,"swing",function(){i("#lightbox img").attr("src",g).css({opacity:1,backgroundImage:"url('"+g+"')",backgroundSize:new_iw+"px "+new_ih+"px",backgroundPosition:"50% 50%",backgroundRepeat:"no-repeat"}),_(a)})}})):(i("#lightbox").css({marginTop:s}),i("#lightbox img").attr("src",g).css({width:new_iw,height:new_ih}),_(a)):(i("#lightbox img").attr("src",""),i("#lightbox").animate({marginTop:s},{duration:400,start:function(){i("#lightbox img").animate({width:new_iw,height:new_ih},400,"swing",function(){i(this).attr("src",g),_(a)})}})),t.sys.preload_next&&o.length>1&&(t.loop||e+1<o.length)&&(e+1<o.length?i("<img>").attr("src",o[e+1].attr("href")):i("<img>").attr("src",o[0].attr("href")))}}),t.show_hash&&a.attr("href").match(/\/([^\/]+)$/)&&(window.location.hash="image-"+RegExp.$1)},_=function(o){if(t.show_text){var e,n="",h="";t.show_text.match(/alt/)&&(n=o.children("img").attr("alt")),t.show_text.match(/caption/)&&(o.parent("dt").parent("dl").find(t.sys.image_caption).length?h=o.parent("dt").parent("dl").find(t.sys.image_caption).text():o.parent("div").find(t.sys.image_caption).length?h=o.parent("div").find(t.sys.image_caption).text():o.parent("div").parent("figure").find(t.sys.image_caption).length&&(h=o.parent("div").parent("figure").find(t.sys.image_caption).text())),e=t.show_text,n||(e=e.replace(/alt/,"")),h||(e=e.replace(/caption/,"")),e=(e=e.replace(/(.+)&(.+)/,"$1<br>$2").replace(/&/,"").replace(/(.+)\|.*/,"$1").replace(/\|/,"")).replace(/alt/,n).replace(/caption/,h),i("#lightbox .lightbox_description").html(e||"")}},b=function(){i("#lightbox .lightbox_description").text("")};i(document).on("click","a:has(img)",function(t){a.test(i(this).attr("href"))&&(t.preventDefault(),g(i(this)))}),t.show_hash&&window.location.hash&&i(document).find("a:has(img)").each(function(){a.test(i(this).attr("href"))&&i(this).attr("href").match(/\/([^\/]+)$/)&&RegExp.$1==window.location.hash.substring(7)&&g(i(this))})})}(jQuery);